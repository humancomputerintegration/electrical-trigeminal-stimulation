# encoding: utf-8
# 2020 R1
SetScriptVersion(Version="20.1.164")
system1 = GetSystem(Name="CFX")
setup1 = system1.GetContainer(ComponentName="Setup")
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.157961
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Option = Automatic
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Option = Automatic
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = 0 [kg m^-3]
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = 0 [kg m^-3]
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = 3 [min]
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.Exit()
solutionComponent1 = system1.GetComponent(Name="Solution")
solutionComponent1.Update(AllDependencies=True)
solution1 = system1.GetContainer(ComponentName="Solution")
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1 = system1.GetComponent(Name="Results")
resultsComponent1.Update(AllDependencies=True)
results1 = system1.GetContainer(ComponentName="Results")
results1.Edit()
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_1/BOUNDARY:vent, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /DATA READER/CASE:Case smoke_1/BOUNDARY:vent, view=/VIEW:View 1""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.169072
    Pan = 0, 0
    Rotation Quaternion = 0.659782, 0.00345442, -0.106147, 0.743915
    
  END

END

> update
# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_1/BOUNDARY:vent, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /DATA READER/CASE:Case smoke_1/BOUNDARY:vent, view=/VIEW:View 1""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_1/BOUNDARY:room, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /DATA READER/CASE:Case smoke_1/BOUNDARY:room, view=/VIEW:View 1""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.19129
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Local
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Local
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = User Specified
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = User Specified
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = User Specified
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 1 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = User Specified
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 1 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = User Specified
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 1 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = User Specified
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 1 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = User Specified
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 1 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = User Specified
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.001 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = User Specified
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 1 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = User Specified
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.001 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = User Specified
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 1 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = User Specified
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.169659
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
> delete /VOLUME RENDERING:Volume Rendering 1""")
results1.SendCommand(Command="> autolegend plot=/PARTICLE TRACK:Particle Track 1, view=VIEW:View 1")
results1.SendCommand(Command="""PARTICLE TRACK:Particle Track 1
Activate Filter = Off
Any All Condition = Match ALL
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Symbols = Off
Draw Tracks = On
Filter On Diameter = Off
Filter On End = Off
Filter On Start = Off
Filter On Track Selection = Off
Font = Sans Serif
Input File =  
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Limit Track Option = Up To Current Timestep
Line Width = 1
Max = 0.0 [kg m^-3]
Maximum Number of Tracks = 25
Min = 0.0 [kg m^-3]
Number of Sides = 8
Option = From File
Particle Diameter = 0 [m]
Particle Diameter Condition = gt
Particle Diameter Condition Two = NA
Particle Diameter Two = 0 [m]
Range = Global
Reduction Factor = 1.0
Reduction or Max Tracks = Max Tracks
Show Track Labels = Off
Specular Lighting = On
Surface Drawing = Smooth Shading
Symbol Max Time Selection = User Specified
Symbol Scale Type = Relative
Symbol Size = 1.0
Symbol Size Option = Constant
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Text Colour = 0, 0, 0
Text Colour Mode = Default
Text Height = 0.024
Track Drawing Mode = Line
Track End Distance = 0.0 [m]
Track End Time = 0.0 [s]
Track File Type = CFX4
Track Limit Type = Time
Track Line Width = 2
Track Size = 1.0
Track Start Distance = 0.0 [m]
Track Start Time = 0.0 [s]
Track Symbol = Ball
Transparency = 0.0
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /PARTICLE TRACK:Particle Track 1, view=/VIEW:View 1""")
results1.SendCommand(Command="> autolegend plot=/STREAMLINE:Streamline 1, view=VIEW:View 1")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor.Gradient
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Locator Sampling Method = Equally Spaced
Max = 0.0 [kg m^-4]
Maximum Number of Items = 25
Min = 0.0 [kg m^-4]
Number of Samples = 25
Number of Sides = 8
Range = Global
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = odor.Gradient
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /STREAMLINE:Streamline 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor.Gradient
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All smoke_1 Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Locator Sampling Method = Equally Spaced
Max = 0.0 [kg m^-4]
Maximum Number of Items = 25
Min = 0.0 [kg m^-4]
Number of Samples = 25
Number of Sides = 8
Range = Global
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = odor.Gradient
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /STREAMLINE:Streamline 1, view=/VIEW:View 1""")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:room, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:environment")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor.Gradient
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Location List = vent
Locator Sampling Method = Equally Spaced
Max = 0.0 [kg m^-4]
Maximum Number of Items = 25
Min = 0.0 [kg m^-4]
Number of Samples = 25
Number of Sides = 8
Range = Global
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = odor.Gradient
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /STREAMLINE:Streamline 1, view=/VIEW:View 1""")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = Velocity
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Location List = vent
Locator Sampling Method = Equally Spaced
Max = 0.0 [m s^-1]
Maximum Number of Items = 25
Min = 0.0 [m s^-1]
Number of Samples = 25
Number of Sides = 8
Range = Global
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = Velocity
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command=r"""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_002.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_002.res
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END""")
results1.SendCommand(Command="> load timestep=136")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = Velocity
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Location List = vent
Locator Sampling Method = Equally Spaced
Max = 0.0 [m s^-1]
Maximum Number of Items = 25
Min = 0.0 [m s^-1]
Number of Samples = 25
Number of Sides = 8
Range = Global
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = Velocity
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="> load timestep=136")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = Velocity
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Location List = vent
Locator Sampling Method = Equally Spaced
Max = 0.0 [m s^-1]
Maximum Number of Items = 25
Min = 0.0 [m s^-1]
Number of Samples = 25
Number of Sides = 8
Range = Global
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = Velocity
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="> load timestep=160")
results1.SendCommand(Command="> load timestep=180")
results1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.157961
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = 1 [kg m^-3]
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = 1 [kg m^-3]
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 1 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 1 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END""")
results1.SendCommand(Command="> load timestep=155")
results1.SendCommand(Command="> load timestep=136")
results1.SendCommand(Command="> load timestep=118")
results1.SendCommand(Command="> load timestep=76")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.28796, -0.289191, -0.132889, 0.90321
    
  END

END

> update
> load timestep=77""")
results1.SendCommand(Command="> load timestep=78")
results1.SendCommand(Command="> load timestep=79")
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="> autolegend plot=/STREAMLINE:Streamline 1, view=VIEW:View 1")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = Velocity
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Location List = vent
Locator Sampling Method = Equally Spaced
Max = 1.1 [m s^-1]
Maximum Number of Items = 25
Min = 0.1 [m s^-1]
Number of Samples = 25
Number of Sides = 8
Range = User Specified
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = Velocity
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = Velocity
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Location List = vent
Locator Sampling Method = Equally Spaced
Max = 1.1 [m s^-1]
Maximum Number of Items = 25
Min = 0.1 [m s^-1]
Number of Samples = 25
Number of Sides = 8
Range = User Specified
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = Velocity
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""STREAMLINE:Streamline 1
Absolute Tolerance = 0.0 [m]
Apply Instancing Transform = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = Velocity
Colour Variable Boundary Values = Conservative
Cross Periodics = On
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Draw Streams = On
Draw Symbols = Off
Grid Tolerance = 0.01
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = On
Line Width = 1
Location List = vent
Locator Sampling Method = Equally Spaced
Max = 1.1 [m s^-1]
Maximum Number of Items = 25
Min = 0.2 [m s^-1]
Number of Samples = 25
Number of Sides = 8
Range = User Specified
Reduction Factor = 1.0
Reduction or Max Number = Max Number
Sample Spacing = 0.1
Sampling Aspect Ratio = 1
Sampling Grid Angle = 0 [degree]
Seed Point Type = Equally Spaced Samples
Simplify Geometry = Off
Specular Lighting = On
Stream Drawing Mode = Line
Stream Initial Direction = 0 , 0 , 0 
Stream Size = 1.0
Stream Symbol = Ball
Streamline Direction = Forward
Streamline Maximum Periods = 20
Streamline Maximum Segments = 10000
Streamline Maximum Time = 0.0 [s]
Streamline Type = 3D Streamline
Streamline Width = 2
Surface Drawing = Smooth Shading
Surface Streamline Direction = Forward and Backward
Symbol Size = 1.0
Symbol Start Time = 10.0 [s]
Symbol Stop Time = -10.0 [s]
Symbol Time Interval = 1.0 [s]
Tolerance Mode = Grid Relative
Transparency = 0.0
Variable = Velocity
Variable Boundary Values = Conservative
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command=">highlight regionlist=/DATA READER/CASE:Case smoke_1/BOUNDARY:vent, domainlist=/DATA READER/CASE:Case smoke_1/DOMAIN:person")
results1.SendCommand(Command="> delete /STREAMLINE:Streamline 1")
results1.SendCommand(Command="> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.356699, -0.198655, -0.0422027, 0.911878
    
  END

END

> update
> load timestep=5""")
results1.SendCommand(Command="> load timestep=87")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 25
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="> load timestep=179")
results1.SendCommand(Command="> load timestep=0")
results1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.157961
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorcontrol=
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorcontrol=1[s]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totaltime=180[s]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorcontrol=t/totaltime[kg m^3]
END
END
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = t/totaltime[kg m^3]
Preview Expression Name = odorcontrol
Preview Mode = Query
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = t/totaltime[kg m^3]
Preview Mode = Evaluate
Preview Range Steps = 180
Preview Variable Ranges = t, Time, 0.0, 1.0
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = t/totaltime[kg m^3]
Preview Mode = Evaluate
Preview Range Steps = 180
Preview Variable Ranges = t, Time, 0.0, 180 [s]
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorcontrol=t/totaltime
END
END
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = t/totaltime
Preview Expression Name = odorcontrol
Preview Mode = Query
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = t/totaltime
Preview Mode = Evaluate
Preview Range Steps = 180
Preview Variable Ranges = t, Time, 0.0, 180 [s]
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
concentration=1[kg m^-3]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorcontrol=t/totaltime*concentration
END
END
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = t/totaltime*concentration
Preview Expression Name = odorcontrol
Preview Mode = Query
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = t/totaltime*concentration
Preview Mode = Evaluate
Preview Range Steps = 180
Preview Variable Ranges = t, Time, 0.0, 180 [s]
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorcontrol
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorcontrol
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totaltime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totaltime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END""")
results1.SendCommand(Command="> load timestep=25")
results1.SendCommand(Command="> load timestep=107")
results1.SendCommand(Command="> load timestep=164")
results1.SendCommand(Command="> load timestep=180")
results1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.157961
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.157961
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
totaltime=80[s]
END
END
END""")
Save(Overwrite=True)
setup1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command=r"""VIEW:View 1
  Light Angle = 50, 110
END

VIEW:View 2
  Light Angle = 50, 110
END

VIEW:View 3
  Light Angle = 50, 110
END

VIEW:View 4
  Light Angle = 50, 110
END

> update
DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END""")
results1.SendCommand(Command="> load timestep=0")
results1.SendCommand(Command="> load timestep=0")
results1.SendCommand(Command="> load timestep=1")
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1")
results1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.157961
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
totaltime=180[s]
END
END
END""")
Save(Overwrite=True)
setup1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.Exit()
setup1.Edit()
setup1.Exit()
setup1.Edit()
setup1.Exit()
system2 = GetSystem(Name="Geom")
geometry1 = system2.GetContainer(ComponentName="Geometry")
geometry1.Edit()
geometry1.Exit()
setup1.Edit()
setup1.Exit()
system3 = GetSystem(Name="CFX 1")
geometry2 = system3.GetContainer(ComponentName="Geometry")
geometry2.Edit()
geometry2.Exit()
setup1.Edit()
setup1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.211291
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
EXPRESSION PREVIEW:
Preview Expression = t/totaltime*concentration
Preview Expression Name = odorcontrol
Preview Mode = Query
END""")
setup1.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
      odorcontrol = 
      odorControl = t/totaltime*concentration
    END
  END
END""")
setup1.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
      totaltime = 
      totalTime = 180[s]
    END
  END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorcontrol=t/totaltime*concentration
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
Copy of totalTime=180[s]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
Copy of totalTime=
    END
  END
END""")
setup1.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
odorcontrol=
    END
  END
END""")
setup1.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
      concentration = 
      Concentration = 1[kg m^-3]
    END
  END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorControl=t/totalTime*Concentration
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorControl=t/totalTime*Concentration
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personMove=
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
          WALL VELOCITY: 
            Option = Cartesian Components
            Wall U = 0 [m s^-1]
            Wall V = 0 [m s^-1]
            Wall W = 0 [m s^-1]
          END # WALL VELOCITY:
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
          WALL VELOCITY: 
            Option = Cartesian Components
            Wall U = 0 [m s^-1]
            Wall V = 0 [m s^-1]
            Wall W = 0 [m s^-1]
          END # WALL VELOCITY:
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
          WALL VELOCITY: 
            Option = Cartesian Components
            Wall U = 0 [m s^-1]
            Wall V = 0 [m s^-1]
            Wall W = 0 [m s^-1]
          END # WALL VELOCITY:
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.237921
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

> update
LIBRARY:
CEL:
EXPRESSIONS:
personMoveX=cos(t/totalTime*pi*2)*2.5[m]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
      personMoveX = 
      personX = cos(t/totalTime*pi*2)*2.5[m]
    END
  END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)/totalTime
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)*2.5
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)*2.5[m]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)/totalTime[m]
END
END
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)*2.5[m s^-1]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)/totalTime[m s^-1]
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
          WALL VELOCITY: 
            Option = Cartesian Components
            Wall U = personX
            Wall V = 0 [m s^-1]
            Wall W = personZ
          END # WALL VELOCITY:
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
          WALL VELOCITY: 
            Option = Cartesian Components
            Wall U = personX
            Wall V = 0 [m s^-1]
            Wall W = personZ
          END # WALL VELOCITY:
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
Vocality=1[m s^-1]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)*Vocality
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)*Vocality
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)/totalTime*Vocality
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
          WALL VELOCITY: 
            Option = Cartesian Components
            Wall U = personX
            Wall V = 0 [m s^-1]
            Wall W = personZ
          END # WALL VELOCITY:
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
          WALL VELOCITY: 
            Option = Cartesian Components
            Wall U = personX
            Wall V = 0 [m s^-1]
            Wall W = personZ
          END # WALL VELOCITY:
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solutionComponent1.Reset()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
PRIMITIVE2D:F28.20
  Prim2d Visibility = False
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solutionComponent1.Reset()
setup1.Edit()
Save(Overwrite=True)
setup1.Exit()
system4 = GetSystem(Name="CFX 3")
setup2 = system4.GetContainer(ComponentName="Setup")
setup2.Edit()
setup2.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: person
&replace     BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.Exit()
setup2.Edit()
setup2.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = 0
          Unit Vector Y Component = 0
          Unit Vector Z Component = 0
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = 0
          Unit Vector Y Component = 0
          Unit Vector Z Component = 0
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
Vocality=
    END
  END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)/totalTime
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""PRIMITIVE2D:F28.20
  Prim2d Visibility = False
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, view=/VIEW:View 1""")
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command=r"""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0.722986, 1.75, -1.28632
    Scale = 0.100542
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

> update
DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0.722986, 1.75, -1.28632
    Scale = 0.0732316
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

> update
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.Exit()
solutionComponent1.Reset()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=(t-totalTime/2)*2
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)/totalTime
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=(t-totalTime/2)/totalTime*2
END
END
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)/abs(cos(t/totalTime*pi*2))
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=(t-totalTime/2)/abs(t-totalTime/2)
END
END
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
solutionComponent1.Reset()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
totalTime=60[s]
END
END
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)/abs(cos(t/totalTime*pi*2))
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = 0 [kg m^-3]
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = 0 [kg m^-3]
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
totalTime=20[s]
END
END
END""")
Save(Overwrite=True)
setup1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solutionComponent1.Reset()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)/abs(cos(t/totalTime*pi*2))
END
END
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = cos(t/totalTime*pi*2)/abs(cos(t/totalTime*pi*2))
Preview Expression Name = personX
Preview Mode = Query
END""")
setup1.SendCommand(Command="""EXPRESSION PREVIEW:
Preview Expression = cos(t/totalTime*pi*2)/abs(cos(t/totalTime*pi*2))
Preview Mode = Evaluate
Preview Range Steps = 100
Preview Variable Ranges = t, Time, 0.0, 20 [s]
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=sign(cos(t/totalTime*pi*2))
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/totalTime*pi*2)/2
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/totalTime*pi*2)/2
END
END
END""")
Save(Overwrite=True)
setup1.Exit()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
resultsComponent1.Reset()
resultsComponent1.Refresh()
results1.Edit()
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, view=/VIEW:View 1""")
results1.SendCommand(Command="""VIEW:View 1
Camera Mode = User Specified
CAMERA:
Option = Pivot Point and Quaternion
Pivot Point = 0, 1.75, 0
Scale = 0.227273
Pan = 0, 0
Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17

END

END

> update
ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/totalTime*pi*2)
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*2)*3
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.5 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.5 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totalTime=60[s]
END
END
END""")
setup1.Exit()
solution1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.Exit()
solutionComponent1.Reset()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/totalTime*pi*4)*3
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/totalTime*pi*4)
END
END
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totalTime=300[s]
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/(totalTime/60)*pi*2)*3
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/(totalTime/60)*pi*2)
END
END
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   SOLUTION UNITS: 
    Angle Units = [rad]
    Length Units = [m]
    Mass Units = [kg]
    Solid Angle Units = [sr]
    Temperature Units = [K]
    Time Units = [s]
  END # SOLUTION UNITS:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   SOLUTION UNITS: 
    Angle Units = [rad]
    Length Units = [m]
    Mass Units = [kg]
    Solid Angle Units = [sr]
    Temperature Units = [K]
    Time Units = [s]
  END # SOLUTION UNITS:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   SOLVER CONTROL: 
    Turbulence Numerics = First Order
    ADVECTION SCHEME: 
      Option = High Resolution
    END # ADVECTION SCHEME:
    CONVERGENCE CONTROL: 
      Maximum Number of Coefficient Loops = 10
      Minimum Number of Coefficient Loops = 1
      Timescale Control = Coefficient Loops
    END # CONVERGENCE CONTROL:
    CONVERGENCE CRITERIA: 
      Residual Target = 1.E-4
      Residual Type = RMS
    END # CONVERGENCE CRITERIA:
    IMMERSED SOLID CONTROL: 
      BOUNDARY MODEL: 
        Option = None
      END # BOUNDARY MODEL:
    END # IMMERSED SOLID CONTROL:
    INTERRUPT CONTROL: 
      Option = Any Interrupt
      CONVERGENCE CONDITIONS: 
        Option = Default Conditions
      END # CONVERGENCE CONDITIONS:
    END # INTERRUPT CONTROL:
    TRANSIENT SCHEME: 
      Option = Second Order Backward Euler
      TIMESTEP INITIALISATION: 
        Option = Automatic
      END # TIMESTEP INITIALISATION:
    END # TRANSIENT SCHEME:
  END # SOLVER CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   SOLVER CONTROL: 
    Turbulence Numerics = First Order
    ADVECTION SCHEME: 
      Option = High Resolution
    END # ADVECTION SCHEME:
    CONVERGENCE CONTROL: 
      Maximum Number of Coefficient Loops = 10
      Minimum Number of Coefficient Loops = 1
      Timescale Control = Coefficient Loops
    END # CONVERGENCE CONTROL:
    CONVERGENCE CRITERIA: 
      Residual Target = 1.E-4
      Residual Type = RMS
    END # CONVERGENCE CRITERIA:
    IMMERSED SOLID CONTROL: 
      BOUNDARY MODEL: 
        Option = None
      END # BOUNDARY MODEL:
    END # IMMERSED SOLID CONTROL:
    INTERRUPT CONTROL: 
      Option = Any Interrupt
      CONVERGENCE CONDITIONS: 
        Option = Default Conditions
      END # CONVERGENCE CONDITIONS:
    END # INTERRUPT CONTROL:
    TRANSIENT SCHEME: 
      Option = Second Order Backward Euler
      TIMESTEP INITIALISATION: 
        Option = Automatic
      END # TIMESTEP INITIALISATION:
    END # TRANSIENT SCHEME:
  END # SOLVER CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    EXPORT RESULTS: Export Results 1
      Option = Surface Data
      EXPORT FORMAT: 
        Option = CGNS
      END # EXPORT FORMAT:
      EXPORT FREQUENCY: 
        Option = Every Timestep
      END # EXPORT FREQUENCY:
      EXPORT SURFACE: Export Surface 1
        Option = Selected Variables
        Output Boundary List = room
        Output Variables List = odor
      END # EXPORT SURFACE:Export Surface 1
    END # EXPORT RESULTS:Export Results 1
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    EXPORT RESULTS: Export Results 1
      Option = Surface Data
      EXPORT FORMAT: 
        Option = CGNS
      END # EXPORT FORMAT:
      EXPORT FREQUENCY: 
        Option = Every Timestep
      END # EXPORT FREQUENCY:
      EXPORT SURFACE: Export Surface 1
        Option = Selected Variables
        Output Boundary List = room
        Output Variables List = odor
      END # EXPORT SURFACE:Export Surface 1
    END # EXPORT RESULTS:Export Results 1
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totalTime=300[s]
END
END
END""")
setup1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.Exit()
results1.Edit()
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=95""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=78""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60*pi*2)*3
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/60*pi*2)
END
END
END""")
Save(Overwrite=True)
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/60[s]*pi*2)
END
END
END""")
setup1.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60[s]*pi*2)*3
END
END
END""")
Save(Overwrite=True)
setup1.Exit()
solutionComponent1.Reset()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command="""ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results1.SendCommand(Command="> load timestep=177")
results1.SendCommand(Command="> load timestep=197")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.169091
    Pan = 0, 0
    Rotation Quaternion = 0.132563, 0.849717, 0.453808, 0.233379
    
  END

END

> update
> load timestep=216""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.169091
    Pan = 0, 0
    Rotation Quaternion = 0.0895277, 0.866758, 0.423563, 0.24761
    
  END

END

> update
> load timestep=258""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.169091
    Pan = 0, 0
    Rotation Quaternion = -0.0113859, 0.997225, 0.0726785, 0.0115702
    
  END

END

> update
> load timestep=277""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.169091
    Pan = 0, 0
    Rotation Quaternion = -0.0305563, 0.81801, 0.574034, 0.0203549
    
  END

END

> update
> load timestep=300""")
results1.SendCommand(Command="> load timestep=300")
results1.SendCommand(Command="> load timestep=299")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.182304
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

> update
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.Exit()
results1.Edit()
results1.SendCommand(Command=">session start, filename=D:/workplace/projects/Ansys/Smoke/Smoke_in_room_files/user_files/test.cse, mode=append")
results1.SendCommand(Command=">session stop")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /DEFAULT LEGEND:Default Legend View 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /WIREFRAME:Wireframe, view=/VIEW:View 1""")
results1.SendCommand(Command="!$start = 0; !$finish = 100; !for($i=$start,$i<=$finish,$i++) { > load timestep=$i EXPORT: Export File = export_$i.csv END >export !}")
results1.SendCommand(Command="""!$start = 0;
!$finish = 100;
!for($i=$start,$i<=$finish,$i++) {
> load timestep=$i
EXPORT:
Export File = export_$i.csv
END
>export
!}""")
results1.SendCommand(Command="""SCALAR VARIABLE:odor
Boundary Values = Conservative
User Units = kg m^-3
END""")
results1.SendCommand(Command="""VIEW:Turbo Initialisation View
 Object Visibility List = /WIREFRAME:Wireframe
 Is A Figure = false
END""")
results1.SendCommand(Command="""# Setting Single View: /VIEW:Turbo Initialisation View
VIEWPORT MANAGER:
  Viewport Layout = No Split
  Maximized Viewport = -1
END
>setViewportView cmd=set, view=/VIEW:Turbo Initialisation View, viewport=1""")
results1.SendCommand(Command="""VIEW:Turbo Initialisation View
 Object Visibility List = /WIREFRAME:Wireframe
 Is A Figure = false
END""")
results1.SendCommand(Command="""# Setting Single View: /VIEW:Turbo Initialisation View
VIEWPORT MANAGER:
  Viewport Layout = No Split
  Maximized Viewport = -1
END
>setViewportView cmd=set, view=/VIEW:Turbo Initialisation View, viewport=1""")
results1.SendCommand(Command="""VIEWPORT MANAGER:
  Synchronize Visibility = false
END""")
results1.SendCommand(Command="""VIEWPORT MANAGER:
  Maximized Viewport = -1
  Synchronize Camera = false
  Synchronize Visibility = true
  View Length Units = m
  Viewer Camera Z = -5
  Viewer Eye Point = Normal
  Viewer Eye Separation = 5
  Viewport 1 View = View 1
  Viewport 2 View = View 2
  Viewport 3 View = View 3
  Viewport 4 View = View 4
  Viewport Layout = No Split
  X Split = 0.5
  Y Split = 0.5
END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END""")
results1.SendCommand(Command="> load timestep=11")
results1.SendCommand(Command="> load timestep=54")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /DEFAULT LEGEND:Default Legend View 1, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /WIREFRAME:Wireframe, view=/VIEW:View 1""")
results1.SendCommand(Command=r"""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
!$start = 0;
!$finish = 100;
!for($i=$start,$i<=$finish,$i++) {
> load timestep=$i
EXPORT:
Export File =D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\command_export\export_$i.csv
END
>export
!}""")
results1.SendCommand(Command="""EXPORT:
ANSYS Export Data = Element Heat Flux
ANSYS File Format = ANSYS
ANSYS Reference Temperature = 0.0 [K]
ANSYS Specify Reference Temperature = Off
ANSYS Supplemental HTC = 0.0 [W m^-2 K^-1]
Additional Variable List =  
BC Profile Type = Inlet Velocity
CSV Type = CSV
Case Name = Case smoke_1
Export Connectivity = Off
Export Coord Frame = Global
Export File = D:/workplace/projects/Ansys/Smoke/Smoke_in_room_files/user_files/export_1.csv
Export Geometry = On
Export Location Aliases = 
Export Node Numbers = Off
Export Null Data = On
Export Type = Generic
Export Units System = Current
Export Variable Type = Current
External Export Data = None
Include File Information = Off
Include Header = On
Location = person Default
Location List = person Default
Null Token = null
Overwrite = On
Precision = 8
Separator = \", \"
Spatial Variables = X,Y,Z
Variable List = odor
Vector Brackets = ()
Vector Display = Scalar
END
>export""")
results1.SendCommand(Command=r"""!$start = 0;
!$finish = 100;
!for($i=$start,$i<=$finish,$i++) {
> load timestep=$i
EXPORT:
Export File =D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\command_export\export_$i.csv
END
>export
!}""")
results1.SendCommand(Command=r"""!$start = 0;
!$finish = 100;
!for($i=$start,$i<=$finish,$i++) {
> load timestep=$i
EXPORT:
Export File =D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\command_export\$i.csv
END
>export
!}""")
results1.SendCommand(Command=r"""!$start = 0;
!$finish = 100;

!for($i=$start,$i<=$finish,$i++) {
> load timestep=$i

EXPORT:
Export File =D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\command_export\$i.csv
END
>export
!}""")
results1.SendCommand(Command=r"""!$start = 5;
!$finish = 100;

!for($i=$start,$i<=$finish,$i++) {
> load timestep=$i

EXPORT:
Export File =D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\command_export\$i.csv
END
>export
!}""")
results1.Edit()
results1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END""")
results1.SendCommand(Command="> load timestep=54")
results1.SendCommand(Command="> load timestep=164")
results1.SendCommand(Command="> load timestep=256")
results1.SendCommand(Command="""EXPORT:
ANSYS Export Data = Element Heat Flux
ANSYS File Format = ANSYS
ANSYS Reference Temperature = 0.0 [K]
ANSYS Specify Reference Temperature = Off
ANSYS Supplemental HTC = 0.0 [W m^-2 K^-1]
Additional Variable List =  
BC Profile Type = Inlet Velocity
CSV Type = CSV
Case Name = Case smoke_1
Export Connectivity = Off
Export Coord Frame = Global
Export File = D:/workplace/projects/Ansys/Smoke/Smoke_in_room_files/user_files/1.csv
Export Geometry = On
Export Location Aliases = 
Export Node Numbers = Off
Export Null Data = On
Export Type = Generic
Export Units System = Current
Export Variable Type = Current
External Export Data = None
Include File Information = Off
Include Header = On
Location = person Default
Location List = person Default
Null Token = null
Overwrite = On
Precision = 8
Separator = \", \"
Spatial Variables = X,Y,Z
Variable List = odor
Vector Brackets = ()
Vector Display = Scalar
END
>export""")
results1.SendCommand(Command=r"""!$start = 0;
!$finish = 100;
!for($i=$start; $i<=$finish; $i++) {
> load timestep=$i
EXPORT:
Export File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\command_export\export_$i.csv
END
>export
!}""")
results1.SendCommand(Command=r"""!$start = 0;
!$finish = 300;
!for($i=$start; $i<=$finish; $i++) {
> load timestep=$i
EXPORT:
Export File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\command_export\export_$i.csv
END
>export
!}""")
results1.SendCommand(Command="> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1")
results1.Exit()
results2 = system4.GetContainer(ComponentName="Results")
results2.Edit()
results2.SendCommand(Command="""EXPORT:
ANSYS Export Data = Element Heat Flux
ANSYS File Format = ANSYS
ANSYS Reference Temperature = 0.0 [K]
ANSYS Specify Reference Temperature = Off
ANSYS Supplemental HTC = 0.0 [W m^-2 K^-1]
Additional Variable List =  
BC Profile Type = Inlet Velocity
CSV Type = CSV
Case Name = Case Smoke Moving Person
Export Connectivity = Off
Export Coord Frame = Global
Export File = D:/workplace/projects/Ansys/Smoke/Smoke_in_room_files/user_files/362.csv
Export Geometry = On
Export Location Aliases = 
Export Node Numbers = Off
Export Null Data = On
Export Type = Generic
Export Units System = Current
Export Variable Type = Current
External Export Data = None
Include File Information = Off
Include Header = On
Location = person Default
Location List = person Default
Null Token = null
Overwrite = On
Precision = 8
Separator = \", \"
Spatial Variables = X,Y,Z
Variable List = smoke
Vector Brackets = ()
Vector Display = Scalar
END
>export""")
results2.Exit()
results1.Edit()
results1.SendCommand(Command=r"""VIEW:View 1
  Light Angle = 50, 110
END

VIEW:View 2
  Light Angle = 50, 110
END

VIEW:View 3
  Light Angle = 50, 110
END

VIEW:View 4
  Light Angle = 50, 110
END

> update
DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END""")
results1.SendCommand(Command="> load timestep=300")
results1.SendCommand(Command="> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 200
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = On
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = White Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 200
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Specular Lighting = Off
Surface Drawing = Smooth Shading
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 200
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = White Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 100
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results1.SendCommand(Command="""VIEW:View 1
Camera Mode = User Specified
CAMERA:
Option = Pivot Point and Quaternion
Pivot Point = 0, 1.75, 0
Scale = 0.227273
Pan = 0, 0
Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17

END

END

> update
ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=98""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=88""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=78""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=83""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -0.0607962, 0.902348, 0.240867, -0.352216
    
  END

END

> update
# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, view=/VIEW:View 1""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>hide /DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, view=/VIEW:View 1""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -0.0828145, 0.892378, 0.27303, -0.349658
    
  END

END

> update
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.200523
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

> update
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_1/BOUNDARY:person Default, view=/VIEW:View 1""")
results1.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.26336
    Pan = 0, 0
    Rotation Quaternion = 0, 0, 0, 1
    
  END

END

> update
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results1.SendCommand(Command=r"""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.149775
    Pan = 0, 0
    Rotation Quaternion = 0.354723, 0.17347, -0.0222003, 0.91847
    
  END

END

> update
DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=37""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=77""")
results1.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_1
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_1
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_1.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=196""")
results1.SendCommand(Command="""EXPORT:
ANSYS Export Data = Element Heat Flux
ANSYS File Format = ANSYS
ANSYS Reference Temperature = 0.0 [K]
ANSYS Specify Reference Temperature = Off
ANSYS Supplemental HTC = 0.0 [W m^-2 K^-1]
Additional Variable List =  
BC Profile Type = Inlet Velocity
CSV Type = CSV
Case Name = Case smoke_1
Export Connectivity = Off
Export Coord Frame = Global
Export File = D:/workplace/projects/Ansys/Smoke/Smoke_in_room_files/user_files/export_300.csv
Export Geometry = On
Export Location Aliases = 
Export Node Numbers = Off
Export Null Data = On
Export Type = Generic
Export Units System = Current
Export Variable Type = Current
External Export Data = None
Include File Information = Off
Include Header = On
Location = person Default
Location List = person Default
Null Token = null
Overwrite = On
Precision = 8
Separator = \", \"
Spatial Variables = X,Y,Z
Variable List = odor
Vector Brackets = ()
Vector Display = Scalar
END
>export""")
results1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

> update
> load timestep=300""")
results1.Exit()
setup1.Edit()
setup1.Exit()
geometryComponent1 = system1.GetComponent(Name="Geometry")
meshComponent1 = system1.GetComponent(Name="Mesh")
system5 = system1.Duplicate(
    ComponentsToShare=[geometryComponent1, meshComponent1],
    RelativeTo=system1)
meshComponent2 = system5.GetComponent(Name="Mesh")
meshComponent2.DeleteShare(System=system5)
geometryComponent2 = system5.GetComponent(Name="Geometry")
geometryComponent2.DeleteShare(System=system5)
system5.Delete()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.Exit()
solutionComponent1.Reset()
meshComponent3 = system3.GetComponent(Name="Mesh")
meshComponent3.Refresh()
mesh1 = system3.GetContainer(ComponentName="Mesh")
mesh1.Edit()
mesh1.Exit()
mesh2 = system1.GetContainer(ComponentName="Mesh")
mesh2.Edit()
mesh2.Exit()
mesh1.Edit()
Save(Overwrite=True)
mesh1.Exit()
meshComponent3.Update(AllDependencies=True)
system6 = GetSystem(Name="CFX 2")
meshComponent4 = system6.GetComponent(Name="Mesh")
meshComponent4.Refresh()
mesh3 = system6.GetContainer(ComponentName="Mesh")
mesh3.Edit()
Save(Overwrite=True)
mesh3.Exit()
meshComponent4.Update(AllDependencies=True)
setup3 = system3.GetContainer(ComponentName="Setup")
setup3.Edit()
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F41.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F42.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F43.40
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F41.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F42.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F43.40
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain,to=environment")
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.177416
    Pan = 1.11368, -1.96725
    Rotation Quaternion = -0.41834, -0.337401, -0.0309079, -0.842733
    
  END

END

> update
FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.177416
    Pan = -1.58305, 1.34095
    Rotation Quaternion = -0.618005, -0.064186, -0.192003, -0.759663
    
  END

END

> update
FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F41.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F42.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F43.40
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F41.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F42.40
  Prim2d Visibility = True
END
PRIMITIVE2D:F43.40
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:environment Default,to=person")
setup3.SendCommand(Command=">copy from=/FLOW:Flow Analysis 1/DOMAIN:environment, to=/FLOW:Flow Analysis 1/DOMAIN:Copy of environment")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:room,/FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:vent")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:Copy of environment/BOUNDARY:person")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:environment Default")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> redo")
setup3.SendCommand(Command="> redo")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:person")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="> redo")
setup3.SendCommand(Command="> undo")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:vent")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:room,/FLOW:Flow Analysis 1/DOMAIN:person")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B40
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 1 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Fluid Temperature = 25 [C]
        Option = Isothermal
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B40
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 1 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Fluid Temperature = 25 [C]
        Option = Isothermal
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:environment/BOUNDARY:environment Default")
setup3.SendCommand(Command=">delete /FLOW:Flow Analysis 1/DOMAIN:environment")
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.451888
    Pan = 1.2482, -1.27915
    Rotation Quaternion = 0.642797, -0.00503876, -0.137941, -0.753498
    
  END

END

> update
FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.44947, 0
    Scale = 0.183027
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain/BOUNDARY:Default Domain Default,to=room")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
Concentration=1[kg m^-3]
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totalTime=300[s]
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorControl=t/totalTime*Concentration
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60[s]*pi*2)*3
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personY=sin(t/60[s]*pi*2)
END
END
END""")
Save(Overwrite=True)
setup3.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain,to=environment")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setupComponent1 = system3.GetComponent(Name="Setup")
setupComponent1.Refresh()
Save(Overwrite=True)
setup3.Exit()
setup3.Edit()
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.44947, 0
    Scale = 0.157918
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.Exit()
setupComponent1.Update(AllDependencies=True)
setup3.Edit()
setup3.Exit()
setupComponent1.Reset()
setup3.Edit()
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [g m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain/BOUNDARY:Default Domain Default,to=room")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 1 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Fluid Temperature = 25 [C]
        Option = Isothermal
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 1 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Fluid Temperature = 25 [C]
        Option = Isothermal
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.Exit()
setup1.Edit()
setup1.Exit()
setup3.Edit()
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.44947, 0
    Scale = 0.157918
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 1 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 1 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.Exit()
setup1.Edit()
setup1.Exit()
setup3.Edit()
setup3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.44947, 0
    Scale = 0.157918
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup3.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain,to=environment")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: environment
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: environment
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
total=300[s]
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
  CEL:
    EXPRESSIONS:
      total = 
      totalTime = 300[s]
    END
  END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
Concentration=1[kg m^-3]
END
END
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorControl=t/totalTime*Concentration
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60[s]*pi*2)*3
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60[s]*pi*2)*3
END
END
END""")
setup3.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/60[s]*pi*2)
END
END
END""")
Save(Overwrite=True)
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: environment
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    BOUNDARY: person Default
      Boundary Type = WALL
      Interface Boundary = Off
      Location = F41.40,F42.40,F43.40
    END # BOUNDARY:person Default
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = odor,Velocity,Pressure
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: environment
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup3.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: environment
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
    BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:environment
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup3.Exit()
setup1.Edit()
setup1.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.4514, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup1.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup1.Exit()
setup3.Edit()
Save(Overwrite=True)
setup3.Exit()
solution2 = system3.GetContainer(ComponentName="Solution")
solution2.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-5\CFX\smoke_2.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent2 = system3.GetComponent(Name="Solution")
solutionComponent2.Update(Force=True)
solution2.Exit()
resultsComponent2 = system3.GetComponent(Name="Results")
resultsComponent2.Update(AllDependencies=True)
results3 = system3.GetContainer(ComponentName="Results")
results3.Edit()
results3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1""")
results3.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Use Plot Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 20
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results3.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results3.Edit()
results3.Edit()
results3.Exit()
results3.Edit()
results3.SendCommand(Command="""VIEW:View 1
Light Angle = 50, 110
END

VIEW:View 2
Light Angle = 50, 110
END

VIEW:View 3
Light Angle = 50, 110
END

VIEW:View 4
Light Angle = 50, 110
END

> update
ANIMATION:ANIMATION
QAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_2.wmv
QAnim Save MPEG = Off
QAnim Looping = Bounce
QAnim Looping Cycles = 1
Video Format = wmv

END""")
results3.SendCommand(Command="> autolegend plot=/VOLUME RENDERING:Volume Rendering 1, view=VIEW:View 1")
results3.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = Off
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Line Colour = 0, 0, 0
Line Colour Mode = Default
Line Width = 1
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Render Edge Angle = 0 [degree]
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 200
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results3.SendCommand(Command="""VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = On
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = White Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 200
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.321786, -0.414674, -0.287982, 0.80098
    
  END

END

> update
# Sending visibility action from ViewUtilities
>hide /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -4.32978e-17, 0.707107, 0.707107, 4.32978e-17
    
  END

END

> update
# Sending visibility action from ViewUtilities
>show /DATA READER/CASE:Case smoke_2/BOUNDARY:person Default, view=/VIEW:View 1""")
results3.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_2
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_2.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END""")
results3.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_2
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-5\CFX\smoke_2_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-5\CFX\smoke_2_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_2
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_2.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=290""")
results3.SendCommand(Command=r"""DATA READER:
  Active Case Name = Case smoke_2
  Current Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-5\CFX\smoke_2_001.res
  Master Results File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-5\CFX\smoke_2_001.res
END
DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_2
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_2.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>load timestep=0""")
results3.SendCommand(Command="""DATA READER:
Timestep Match Criterion = Same Step
Timestep Sync Mode = By Time Value
Timevalue Match Criterion = Same Value
END
ANIMATION: ANIMATION
TimeAnim Control Case = Case smoke_2
TimeAnim Control Variable = Timestep
TimeAnim Frame Interval = All Timesteps
TimeAnim Frame Spacing = Equal In Time
TimeAnim Number Of Frames = 21
TimeAnim Timestep Interval = 1
TimeAnim Specify Range = Off
TimeAnim MPEG Filename = C:/Users/Muphy/Documents/smoke_2.wmv
TimeAnim Save MPEG = Off
TimeAnim Looping Cycles = 1
Video Format = wmv
END
>animate timestepAnimate""")
results3.SendCommand(Command="""# Sending visibility action from ViewUtilities
>show /VOLUME RENDERING:Volume Rendering 1, view=/VIEW:View 1""")
results3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -0.0126601, 0.920277, 0.390884, -0.0118684
    
  END

END

> update
VOLUME RENDERING:Volume Rendering 1
Apply Instancing Transform = On
Apply Texture = On
Blend Texture = On
Colour = 0.75, 0.75, 0.75
Colour Map = Default Colour Map
Colour Mode = Variable
Colour Scale = Linear
Colour Variable = odor
Colour Variable Boundary Values = Hybrid
Culling Mode = No Culling
Domain List = /DOMAIN GROUP:All Domains
Draw Faces = On
Draw Lines = Off
Instancing Transform = /DEFAULT INSTANCE TRANSFORM:Default Transform
Lighting = Off
Max = 0.0 [kg m^-3]
Min = 0.0 [kg m^-3]
Range = Global
Specular Lighting = Off
Surface Drawing = Smooth Shading
Texture Angle = 0
Texture Direction = 0 , 1 , 0 
Texture File =  
Texture Material = White Metal
Texture Position = 0 , 0 
Texture Scale = 1
Texture Type = Predefined
Tile Texture = Off
Transform Texture = Off
Transparency = 0.2
Transparency Colour Map = Transparency
Variable = odor
Variable Boundary Values = Hybrid
Volume Rendering Max = 0.0 [kg m^-3]
Volume Rendering Min = 0.0 [kg m^-3]
Volume Rendering Range = Global
Volume Rendering Scale = Linear
Volume Resolution = 200
  OBJECT VIEW TRANSFORM:
  Apply Reflection = Off
  Apply Rotation = Off
  Apply Scale = Off
  Apply Translation = Off
  Principal Axis = Z
  Reflection Plane Option = XY Plane
  Rotation Angle = 0.0 [degree]
  Rotation Axis From = 0 [m], 0 [m], 0 [m]
  Rotation Axis To = 0 [m], 0 [m], 0 [m]
  Rotation Axis Type = Principal Axis
  Scale Vector = 1 , 1 , 1 
  Translation Vector = 0 [m], 0 [m], 0 [m]
  X = 0.0 [m]
  Y = 0.0 [m]
  Z = 0.0 [m]
  END
END""")
results3.SendCommand(Command="> load timestep=142")
results3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -0.379123, 0.207696, 0.0717351, -0.898882
    
  END

END

> update
> load timestep=149""")
results3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -0.455807, -0.396308, -0.145928, -0.783513
    
  END

END

> update
> load timestep=167""")
results3.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -0.304706, -0.703055, -0.49995, -0.403643
    
  END

END

> update
> load timestep=300""")
results3.SendCommand(Command=r"""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.227273
    Pan = 0, 0
    Rotation Quaternion = -0.191674, 0.561568, 0.22892, -0.771691
    
  END

END

> update
!$start = 0;
!$finish = 300;
!for($i=$start; $i<=$finish; $i++) {
> load timestep=$i
EXPORT:
Export File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\smoke_2\export_$i.csv
END
>export
!}""")
results3.Edit()
results3.Exit()
results3.Edit()
results3.Exit()
results3.Edit()
results3.Exit()
results3.Edit()
results3.SendCommand(Command="""EXPORT:
ANSYS Export Data = Element Heat Flux
ANSYS File Format = ANSYS
ANSYS Reference Temperature = 0.0 [K]
ANSYS Specify Reference Temperature = Off
ANSYS Supplemental HTC = 0.0 [W m^-2 K^-1]
Additional Variable List =  
BC Profile Type = Inlet Velocity
CSV Type = CSV
Case Name = Case smoke_2
Export Connectivity = Off
Export Coord Frame = Global
Export File = D:/workplace/projects/Ansys/Smoke/Smoke_in_room_files/user_files/export.csv
Export Geometry = On
Export Location Aliases = 
Export Node Numbers = Off
Export Null Data = On
Export Type = Generic
Export Units System = Current
Export Variable Type = Current
External Export Data = None
Include File Information = Off
Include Header = On
Location = person Default
Location List = person Default
Null Token = null
Overwrite = On
Precision = 8
Separator = \", \"
Spatial Variables = X,Y,Z
Variable List = odor
Vector Brackets = ()
Vector Display = Scalar
END
>export""")
results3.SendCommand(Command=r"""!$start = 0;
!$finish = 300;
!for($i=$start; $i<=$finish; $i++) {
> load timestep=$i
EXPORT:
Export File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\smoke_2\export_$i.csv
END
>export
!}""")
results3.Exit()
solution1.SetExecutionControl(CCL=r"""&replace SIMULATION CONTROL:
  EXECUTION CONTROL:
    EXECUTABLE SELECTION:
      Double Precision = Off
      Large Problem = Off
    END
    INTERPOLATOR STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
    END
    PARTITIONER STEP CONTROL:
      Multidomain Option = Automatic
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARTITION SMOOTHING:
        Maximum Partition Smoothing Sweeps = 100
        Option = Smooth
      END
      PARTITIONING TYPE:
        MeTiS Type = k-way
        Option = MeTiS
        Partition Size Rule = Automatic
      END
    END
    RUN DEFINITION:
      Run Mode = Full
      Solver Input File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\dp0\CFX-4\CFX\smoke_1.def
    END
    SOLVER STEP CONTROL:
      Runtime Priority = Standard
      MEMORY CONTROL:
        Memory Allocation Factor = 1.0
      END
      PARALLEL ENVIRONMENT:
        Number of Processes = 6
        Start Method = Intel MPI Local Parallel
      END
    END
  END
END
""")
solutionComponent1.Update(Force=True)
solution1.Exit()
resultsComponent1.Update(AllDependencies=True)
results1.Edit()
results1.SendCommand(Command="""VIEW:View 1
  Light Angle = 50, 110
END

VIEW:View 2
  Light Angle = 50, 110
END

VIEW:View 3
  Light Angle = 50, 110
END

VIEW:View 4
  Light Angle = 50, 110
END

> update
EXPORT:
ANSYS Export Data = Element Heat Flux
ANSYS File Format = ANSYS
ANSYS Reference Temperature = 0.0 [K]
ANSYS Specify Reference Temperature = Off
ANSYS Supplemental HTC = 0.0 [W m^-2 K^-1]
Additional Variable List =  
BC Profile Type = Inlet Velocity
CSV Type = CSV
Case Name = Case smoke_1
Export Connectivity = Off
Export Coord Frame = Global
Export File = D:/workplace/projects/Ansys/Smoke/Smoke_in_room_files/user_files/export_300.csv
Export Geometry = On
Export Location Aliases = 
Export Node Numbers = Off
Export Null Data = On
Export Type = Generic
Export Units System = Current
Export Variable Type = Current
External Export Data = None
Include File Information = Off
Include Header = On
Location = person Default
Location List = person Default
Null Token = null
Overwrite = On
Precision = 8
Separator = \", \"
Spatial Variables = X,Y,Z
Variable List = odor
Vector Brackets = ()
Vector Display = Scalar
END
>export""")
results1.SendCommand(Command=r"""!$start = 0;
!$finish = 300;
!for($i=$start; $i<=$finish; $i++) {
> load timestep=$i
EXPORT:
Export File = D:\workplace\projects\Ansys\Smoke\Smoke_in_room_files\user_files\smoke_1\export_$i.csv
END
>export
!}""")
results1.Exit()
setup4 = system6.GetContainer(ComponentName="Setup")
setup4.Edit()
setup4.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
Concentration=1[kg m^-3]
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totalTime=300[s]
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorControl=t/totalTime*Concentration
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60[s]*pi*2)*3
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/60[s]*pi*2)*3
END
END
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.Exit()
setupComponent2 = system6.GetComponent(Name="Setup")
setupComponent2.Reset()
setup4.Edit()
setup4.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.Exit()
setupComponent2.Reset()
setup4.Edit()
setup4.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totalTime=300[s]
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
Concentration=1[kg m^-3]
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorControl=t/totalTime*Concentration
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60[s]*pi*2)*3
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/60[s]*pi*2)
END
END
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: Default Domain Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20,F28.20
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:Default Domain Default
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: Default Domain Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20,F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:Default Domain Default
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Eddy Viscosity Ratio = 10.
          Fractional Intensity = 0.05
          Option = Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain/BOUNDARY:Default Domain Default,to=room")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.46174, 0
    Scale = 0.158193
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: room
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:room
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain,to=environment")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = Pressure,Velocity,odor
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = Pressure,Velocity,odor
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup4.Exit()
setupComponent2.Reset()
setup4.Edit()
setup4.Exit()
setupComponent2.Reset()
setup4.Edit()
setup4.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

VIEW:View 1
  Light Angle = 50, 110
END

> update
LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""LIBRARY: 
&replace   ADDITIONAL VARIABLE: odor
    Option = Definition
    Tensor Type = SCALAR
    Units = [kg m^-3 ]
    Variable Type = Volumetric
  END # ADDITIONAL VARIABLE:odor
END # LIBRARY:


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
totalTime=300[s]
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
Concentration=1[kg m^-3]
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
odorControl=t/totalTime*Concentration
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personX=cos(t/60[s]*pi*2)*3
END
END
END""")
setup4.SendCommand(Command="""LIBRARY:
CEL:
EXPRESSIONS:
personZ=sin(t/60[s]*pi*2)
END
END
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: person
    Coord Frame = Coord 0
    Domain Type = Immersed Solid
    Location = B40
    DOMAIN MODELS: 
      DOMAIN MOTION: 
        Linear Velocity = 0.2 [m s^-1]
        Option = Speed and Direction
        TRANSLATION DIRECTION: 
          Option = Cartesian Components
          Unit Vector X Component = personX
          Unit Vector Y Component = 0
          Unit Vector Z Component = personZ
        END # TRANSLATION DIRECTION:
      END # DOMAIN MOTION:
    END # DOMAIN MODELS:
  END # DOMAIN:person
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: Default Domain Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20,F28.20
      BOUNDARY CONDITIONS: 
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:Default Domain Default
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   DOMAIN: Default Domain
    Coord Frame = Coord 0
    Domain Type = Fluid
    Location = B20
    BOUNDARY: Default Domain Default
      Boundary Type = WALL
      Create Other Side = Off
      Interface Boundary = Off
      Location = F21.20,F22.20,F23.20,F24.20,F25.20,F26.20,F27.20,F28.20
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Option = Zero Flux
        END # ADDITIONAL VARIABLE:odor
        MASS AND MOMENTUM: 
          Option = No Slip Wall
        END # MASS AND MOMENTUM:
        WALL ROUGHNESS: 
          Option = Smooth Wall
        END # WALL ROUGHNESS:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:Default Domain Default
    DOMAIN MODELS: 
      BUOYANCY MODEL: 
        Option = Non Buoyant
      END # BUOYANCY MODEL:
      DOMAIN MOTION: 
        Option = Stationary
      END # DOMAIN MOTION:
      MESH DEFORMATION: 
        Option = None
      END # MESH DEFORMATION:
      REFERENCE PRESSURE: 
        Reference Pressure = 0 [atm]
      END # REFERENCE PRESSURE:
    END # DOMAIN MODELS:
    FLUID DEFINITION: Fluid 1
      Material = Air at 25 C
      Option = Material Library
      MORPHOLOGY: 
        Option = Continuous Fluid
      END # MORPHOLOGY:
    END # FLUID DEFINITION:Fluid 1
    FLUID MODELS: 
      ADDITIONAL VARIABLE: odor
        Kinematic Diffusivity = 1e-4 [m^2 s^-1]
        Option = Transport Equation
      END # ADDITIONAL VARIABLE:odor
      COMBUSTION MODEL: 
        Option = None
      END # COMBUSTION MODEL:
      HEAT TRANSFER MODEL: 
        Option = None
      END # HEAT TRANSFER MODEL:
      THERMAL RADIATION MODEL: 
        Option = None
      END # THERMAL RADIATION MODEL:
      TURBULENCE MODEL: 
        Option = k epsilon
      END # TURBULENCE MODEL:
      TURBULENT WALL FUNCTIONS: 
        Option = Scalable
      END # TURBULENT WALL FUNCTIONS:
    END # FLUID MODELS:
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""VIEW:View 1
  Camera Mode = User Specified
  CAMERA:
    Option = Pivot Point and Quaternion
    Pivot Point = 0, 1.75, 0
    Scale = 0.164949
    Pan = 0, 0
    Rotation Quaternion = 0.279848, -0.364705, -0.115917, 0.880476
    
  END

END

> update
FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Option = Medium Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
  DOMAIN: Default Domain
&replace     BOUNDARY: vent
      Boundary Type = INLET
      Interface Boundary = Off
      Location = vent
      BOUNDARY CONDITIONS: 
        ADDITIONAL VARIABLE: odor
          Additional Variable Value = odorControl
          Option = Value
        END # ADDITIONAL VARIABLE:odor
        FLOW REGIME: 
          Option = Subsonic
        END # FLOW REGIME:
        MASS AND MOMENTUM: 
          Normal Speed = 1 [m s^-1]
          Option = Normal Speed
        END # MASS AND MOMENTUM:
        TURBULENCE: 
          Option = Medium Intensity and Eddy Viscosity Ratio
        END # TURBULENCE:
      END # BOUNDARY CONDITIONS:
    END # BOUNDARY:vent
  END # DOMAIN:Default Domain
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain/BOUNDARY:Default Domain Default,to=room")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:Default Domain,to=nvironment")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command="""PRIMITIVE2D:F21.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F22.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F23.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F24.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F25.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F26.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F27.20
  Prim2d Visibility = True
END
PRIMITIVE2D:F28.20
  Prim2d Visibility = True
END""")
setup4.SendCommand(Command=">rename from=/FLOW:Flow Analysis 1/DOMAIN:nvironment,to=environment")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   ANALYSIS TYPE: 
    Option = Transient
    EXTERNAL SOLVER COUPLING: 
      Option = None
    END # EXTERNAL SOLVER COUPLING:
    INITIAL TIME: 
      Option = Automatic with Value
      Time = 0 [s]
    END # INITIAL TIME:
    TIME DURATION: 
      Option = Total Time
      Total Time = totalTime
    END # TIME DURATION:
    TIME STEPS: 
      Option = Timesteps
      Timesteps = 1 [s]
    END # TIME STEPS:
  END # ANALYSIS TYPE:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   INITIALISATION: 
    Option = Automatic
    INITIAL CONDITIONS: 
      Velocity Type = Cartesian
      ADDITIONAL VARIABLE: odor
        Additional Variable Value = 0 [kg m^-3]
        Option = Automatic with Value
      END # ADDITIONAL VARIABLE:odor
      CARTESIAN VELOCITY COMPONENTS: 
        Option = Automatic with Value
        U = 0 [m s^-1]
        V = 0 [m s^-1]
        W = 0 [m s^-1]
      END # CARTESIAN VELOCITY COMPONENTS:
      STATIC PRESSURE: 
        Option = Automatic with Value
        Relative Pressure = 0 [Pa]
      END # STATIC PRESSURE:
      TURBULENCE INITIAL CONDITIONS: 
        Option = Medium Intensity and Eddy Viscosity Ratio
      END # TURBULENCE INITIAL CONDITIONS:
    END # INITIAL CONDITIONS:
  END # INITIALISATION:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = Pressure,Velocity,odor
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
setup4.SendCommand(Command="""FLOW: Flow Analysis 1
&replace   OUTPUT CONTROL: 
    RESULTS: 
      File Compression Level = Default
      Option = Standard
    END # RESULTS:
    TRANSIENT RESULTS: Transient Results 1
      File Compression Level = Default
      Include Mesh = No
      Option = Selected Variables
      Output Variables List = Pressure,Velocity,odor
      OUTPUT FREQUENCY: 
        Option = Every Timestep
      END # OUTPUT FREQUENCY:
    END # TRANSIENT RESULTS:Transient Results 1
  END # OUTPUT CONTROL:
END # FLOW:Flow Analysis 1


PARAMETERIZATION:
END""")
Save(Overwrite=True)
setup4.Exit()
solutionComponent3 = system6.GetComponent(Name="Solution")
solutionComponent3.Update(AllDependencies=True)
Save(Overwrite=True)
